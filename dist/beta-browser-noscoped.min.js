/*!
betajs-browser - v1.0.0 - 2015-02-22
Copyright (c) Oliver Friedmann
MIT Software License.
*/
(function(){var a=this.subScope();a.binding("module","global:BetaJS.Browser"),a.binding("base","global:BetaJS"),a.binding("jquery","global:jQuery"),a.define("base:$",["jquery:"],function(a){return a}),a.define("module:",function(){return{guid:"02450b15-9bbf-4be2-b8f6-b483bc015d06",version:"9.1424627156093"}}),a.define("module:JQueryAjax",["base:Net.AbstractAjax","base:Net.AjaxException","base:Promise","module:Info","jquery:"],function(a,b,c,d,e,f){return a.extend({scoped:f},function(){return{_syncCall:function(a){var c;return e.ajax({type:a.method,async:!1,url:a.uri,dataType:a.decodeType?a.decodeType:null,data:a.encodeType&&"json"==a.encodeType?JSON.stringify(a.data):a.data,success:function(a){c=a},error:function(a,c,d){var e="";try{e=JSON.parse(a.responseText)}catch(f){e=JSON.parse('"'+a.responseText+'"')}throw new b(a.status,d,ee)}}),c},_asyncCall:function(a){var f=c.create();return d.isInternetExplorer()&&d.internetExplorerVersion()<=9&&(e.support.cors=!0),e.ajax({type:a.method,async:!0,url:a.uri,dataType:a.decodeType?a.decodeType:null,data:a.encodeType&&"json"==a.encodeType?JSON.stringify(a.data):a.data,success:function(a){f.asyncSuccess(a)},error:function(a,c,d){var e="";try{e=JSON.parse(a.responseText)}catch(g){e=JSON.parse('"'+a.responseText+'"')}f.asyncError(new b(a.status,d,e))}}),f}}})}),a.define("module:Cookies",["base:Strings"],function(a){return{get:function(b){return a.read_cookie_string(document.cookie,b)},set:function(b,c){document.cookie=a.write_cookie_string(document.cookie,b,c)}}}),a.define("module:Dom",["base:Objs","jquery:"],function(a,b){return{traverseNext:function(a,c){return"get"in a&&(a=a.get(0)),a.firstChild&&!c?b(a.firstChild):a.parentNode?a.nextSibling?b(a.nextSibling):this.traverseNext(a.parentNode,!0):null},selectNode:function(a,c){a=b(a).get(0);var d=null,e=null;window.getSelection?(d=window.getSelection(),d.removeAllRanges(),e=document.createRange()):document.selection&&(d=document.selection,e=d.createRange()),c?(e.setStart(a,c),e.setEnd(a,c),d.addRange(e)):(e.selectNode(a),d.addRange(e))},selectionStartNode:function(){return window.getSelection?b(window.getSelection().getRangeAt(0).startContainer):document.selection?b(document.selection.createRange().startContainer):null},selectedHtml:function(){return window.getSelection?window.getSelection().toString():document.selection?document.selection.createRange().htmlText:""},selectionAncestor:function(){return window.getSelection?b(window.getSelection().getRangeAt(0).commonAncestorContainer):document.selection?b(document.selection.createRange().parentElement()):null},selectionStartOffset:function(){return window.getSelection?window.getSelection().getRangeAt(0).startOffset:document.selection?document.selection.createRange().startOffset:null},selectionEndOffset:function(){return window.getSelection?window.getSelection().getRangeAt(0).endOffset:document.selection?document.selection.createRange().endOffset:null},selectionStart:function(){return window.getSelection?b(window.getSelection().getRangeAt(0).startContainer):document.selection?b(document.selection.createRange().startContainer):null},selectionEnd:function(){return window.getSelection?b(window.getSelection().getRangeAt(0).endContainer):document.selection?b(document.selection.createRange().endContainer):null},selectionNonEmpty:function(){var a=this.selectionStart(),b=this.selectionEnd();return a&&b&&a.get(0)&&b.get(0)&&(a.get(0)!=b.get(0)||this.selectionStartOffset()!=this.selectionEndOffset())},selectionContained:function(a){return a.has(this.selectionStart()).length>0&&a.has(this.selectionEnd()).length>0},selectionNodes:function(){var a=[],b=this.selectionStart(),c=this.selectionEnd();a.push(b);for(var d=b;d.get(0)!=c.get(0);)d=this.traverseNext(d),a.push(d);return a},selectionLeaves:function(){return a.filter(this.selectionNodes(),function(a){return 0===a.children().length})},contentSiblings:function(a){return a.parent().contents().filter(function(){return this!=a.get(0)})},remove_tag_from_parent_path:function(a,c,d){c=c.toLowerCase(),a=b(a);for(var e=a.parents(d?d+" "+c:c),f=0;f<e.length;++f){var g=e.get(f);for(g=b(g);a.get(0)!=g.get(0);)this.contentSiblings(a).wrap("<"+c+"></"+c+">"),a=a.parent();g.contents().unwrap()}},selectionSplitOffsets:function(){var a=this.selectionStartOffset(),c=this.selectionEndOffset(),d=this.selectionStart(),e=this.selectionEnd(),f=d.get(0)==e.get(0);if(c<e.get(0).wholeText.length){var g=e.get(0);g.splitText(c),e=b(g),f&&(d=e)}a>0&&(d=b(d.get(0).splitText(a)),f&&(e=d)),this.selectRange(d,e)},selectRange:function(a,c,d,e){a=b(a),c=b(c);var f=null,g=null;window.getSelection?(f=window.getSelection(),f.removeAllRanges(),g=document.createRange()):document.selection&&(f=document.selection,g=f.createRange()),g.setStart(a.get(0),d||0),g.setEnd(c.get(0),e||c.get(0).data.length),f.addRange(g)},splitNode:function(a,c,d){if(a=b(a),c=c||0,d=d||a.get(0).data.length,d<a.get(0).data.length){var e=a.get(0);e.splitText(d),a=b(e)}return c>0&&(a=b(a.get(0).splitText(c))),a}}}),a.define("module:Hotkeys",["base:Objs","jquery:"],function(a,b){return{SHIFT_NUMS:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},SPECIAL_KEYS:{esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},MODIFIERS:["ctrl","alt","shift","meta"],keyCodeToCharacter:function(a){return 188==a?",":190==a?".":String.fromCharCode(a).toLowerCase()},register:function(c,d,e,f){var g=this;f=a.extend({type:"keyup",propagate:!1,disable_in_input:!1,target:document,keycode:!1},f),f.target=b(f.target);var h=c.toLowerCase().split("+"),i=function(b){if(f.disable_in_input){var c=b.target||b.srcElement||null;if(c&&3==c.nodeType&&(c=c.parentNode),c&&("INPUT"==c.tagName||"TEXTAREA"==c.tagName))return}var i=b.keyCode||b.which||0,j=g.keyCodeToCharacter(i),k=0,l={};a.iter(g.MODIFIERS,function(a){l[a]={pressed:b[a+"Key"],wanted:!1}},this),a.iter(h,function(a){a in l?(l[a].wanted=!0,k++):a.length>1?g.SPECIAL_KEYS[a]==i&&k++:f.keycode?f.keycode==i&&k++:(j==a||b.shiftKey&&g.SHIFT_NUMS[j]==a)&&k++},this),k==h.length&&a.all(l,function(a){return a.wanted==a.pressed})&&(d.apply(e||this),f.propagate||b.preventDefault())};return f.target.on(f.type,i),{target:f.target,type:f.type,func:i}},unregister:function(a){a.target.off(a.type,a.func)}}}),a.define("module:Info",["module:FlashDetect"],function(a){return{getNavigator:function(){return{appCodeName:navigator.appCodeName,appName:navigator.appName,appVersion:navigator.appVersion,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,platform:navigator.platform,userAgent:navigator.userAgent}},__cache:{},__cached:function(a,b){return a in this.__cache||(this.__cache[a]=b.apply(this)),this.__cache[a]},flash:function(){return this.__cached("flash",function(){return new a})},isiOS:function(){return this.__cached("isiOS",function(){var a=navigator.userAgent;return-1!=a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad")})},isChrome:function(){return this.__cached("isChrome",function(){return("chrome"in window||-1!=navigator.userAgent.indexOf("CriOS"))&&!window.opera&&-1===navigator.userAgent.indexOf(" OPR/")})},isOpera:function(){return this.__cached("isOpera",function(){return!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0})},isAndroid:function(){return this.__cached("isAndroid",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("android")})},isWebOS:function(){return this.__cached("isWebOS",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("webos")})},isWindowsPhone:function(){return this.__cached("isWindowsPhone",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("windows phone")})},isBlackberry:function(){return this.__cached("isBlackberry",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("blackberry")})},iOSversion:function(){return this.__cached("iOSversion",function(){if(!this.isiOS())return!1;var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return{major:parseInt(a[1],10),minor:parseInt(a[2],10),revision:parseInt(a[3]||0,10)}})},isMobile:function(){return this.__cached("isMobile",function(){return this.isiOS()||this.isAndroid()||this.isWebOS()||this.isWindowsPhone()||this.isBlackberry()})},isInternetExplorer:function(){return this.__cached("isInternetExplorer",function(){return null!==this.internetExplorerVersion()})},isFirefox:function(){return this.__cached("isFirefox",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("firefox")})},isSafari:function(){return this.__cached("isSafari",function(){return!this.isChrome()&&-1!=navigator.userAgent.toLowerCase().indexOf("safari")})},isWindows:function(){return this.__cached("isWindows",function(){return-1!=navigator.appVersion.toLowerCase().indexOf("win")})},isMacOS:function(){return this.__cached("isMacOS",function(){return!this.isiOS()&&-1!=navigator.appVersion.toLowerCase().indexOf("mac")})},isUnix:function(){return this.__cached("isUnix",function(){return-1!=navigator.appVersion.toLowerCase().indexOf("x11")})},isLinux:function(){return this.__cached("isLinux",function(){return-1!=navigator.appVersion.toLowerCase().indexOf("linux")})},internetExplorerVersion:function(){if("Microsoft Internet Explorer"==navigator.appName){var a=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(a.exec(navigator.userAgent))return parseFloat(RegExp.$1)}else if("Netscape"==navigator.appName){var b=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(b.exec(navigator.userAgent))return parseFloat(RegExp.$1)}return null},inIframe:function(){try{return window.self!==window.top}catch(a){return!0}},formatDevice:function(){return this.isMobile()?"Mobile":"Desktop"},formatOS:function(){return this.__cached("formatOS",function(){return this.isMacOS()?"Mac OS-X":this.isWindows()?"Windows":this.isUnix()?"Unix":this.isLinux()?"Linux":this.isiOS()?"iOS "+this.iOSversion().major+"."+this.iOSversion().minor+"."+this.iOSversion().revision:this.isAndroid()?"Android":this.isWebOS()?"WebOS":this.isWindowsPhone()?"Windows Phone":this.isBlackberry()?"Blackberry":"Unknown Operating System"})},formatBrowser:function(){return this.__cached("formatBrowser",function(){return this.isChrome()?"Chrome":this.isOpera()?"Opera":this.isInternetExplorer()?"Internet Explorer "+this.internetExplorerVersion():this.isFirefox()?"Firefox":this.isSafari()?"Safari":this.isAndroid()?"Android":this.isWebOS()?"WebOS":this.isWindowsPhone()?"Windows Phone":this.isBlackberry()?"Blackberry":"Unknown Browser"})},formatFlash:function(){return this.flash().installed()?"Flash "+this.flash().version().raw:this.flash().supported()?"Flash not installed but supported":"Flash not supported"}}}),a.define("module:FlashDetect",["base:Class"],function(a,b){return a.extend({scoped:b},function(a){return{constructor:function(){if(a.constructor.call(this),this.__version=null,navigator.plugins&&navigator.plugins.length>0){var b="application/x-shockwave-flash",c=navigator.mimeTypes;c&&c[b]&&c[b].enabledPlugin&&c[b].enabledPlugin.description&&(this.__version=this.parseVersion(c[b].enabledPlugin.description))}else if(-1==navigator.appVersion.indexOf("Mac")&&window.execScript)for(var d=0;d<this.__activeXDetectRules.length;d++)try{var e=new ActiveXObject(this.__activeXDetectRules[d].name),f=this.__activeXDetectRules[d].version(e);if(f){this.__version=this.parseActiveXVersion(f);break}}catch(g){}},parseVersion:function(a){var b=a.split(/ +/),c=b[2].split(/\./),d=b[3];return{raw:a,major:parseInt(c[0],10),minor:parseInt(c[1],10),revisionStr:d,revision:parseInt(d.replace(/[a-zA-Z]/g,""),10)}},parseActiveXVersion:function(a){var b=a.split(",");return{raw:a,major:parseInt(b[0].split(" ")[1],10),minor:parseInt(b[1],10),revision:parseInt(b[2],10),revisionStr:b[2]}},version:function(){return this.__version},installed:function(){return null!==this.__version},supported:function(){var a=navigator.userAgent;return this.installed()||!(-1!=a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad"))},majorAtLeast:function(a){return this.installed()&&this.version().major>=a},minorAtLeast:function(a){return this.installed()&&this.version().minor>=a},revisionAtLeast:function(a){return this.installed()&&this.version().revision>=a},versionAtLeast:function(){if(!this.installed())return!1;var a=[this.version().major,this.version().minor,this.version().revision],b=Math.min(a.length,arguments.length);for(i=0;i<b;i++)if(a[i]!=arguments[i])return a[i]>arguments[i];return!0},__activeXDetectRules:[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(a){try{return a.GetVariable("$version")}catch(b){return null}}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(a){try{a.AllowScriptAccess="always";try{return a.GetVariable("$version")}catch(b){return null}}catch(b){return"6,0,21"}}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(a){try{return a.GetVariable("$version")}catch(b){return null}}}]}})}),a.define("module:Loader",["jquery:"],function(a){return{loadScript:function(a,b,c){var d=!1,e=document.getElementsByTagName("head")[0],f=document.createElement("script");f.src=a,f.onload=f.onreadystatechange=function(){d||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(d=!0,f.onload=f.onreadystatechange=null,b&&b.call(c||this,a))},e.appendChild(f)},loadStyles:function(a,b,c){var d=!1,e=document.getElementsByTagName("head")[0],f=document.createElement("link");f.rel="stylesheet",f.href=a,f.onload=f.onreadystatechange=function(){d||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(d=!0,f.onload=f.onreadystatechange=null,b&&b.call(c||this,a))},e.appendChild(f)},inlineStyles:function(b){a("<style>"+b+"</style>").appendTo("head")},loadHtml:function(b,c,d){a.ajax({url:b,dataType:"html"}).done(function(a){c.call(d||this,a,b)})}}}),a.define("module:Router",["base:Class","base:Events.EventsMixin","base:Events.Events","base:Functions","base:Types","base:Objs"],function(a,b,c,d,e,f,g){return a.extend({scoped:g},[b,function(a){return{routes:[],constructor:function(b){a.constructor.call(this);var c=e.is_function(this.routes)?this.routes():this.routes;e.is_array(c)||(c=[c]),"routes"in b&&(e.is_array(b.routes)?c=c.concat(b.routes):c.push(b.routes)),this.__routes=[],this.__paths={},this.__current=null,f.iter(c,function(a){f.iter(a,function(a,b){e.is_string(a)&&(a={action:a}),a.key=b,a.route=new RegExp("^"+b+"$"),"applicable"in a?e.is_array(a.applicable)||(a.applicable=[a.applicable]):a.applicable=[],"valid"in a?e.is_array(a.valid)||(a.valid=[a.valid]):a.valid=[],"path"in a||(a.path=a.key),this.__routes.push(a),this.__paths[a.path]=a},this)},this),"actions"in b&&f.iter(b.actions,function(a,b){this[b]=a},this)},destroy:function(){this.__leave(),a.destroy.call(this)},parse:function(a){for(var b=0;b<this.__routes.length;++b){var c=this.__routes[b],d=c.route.exec(a);if(null!==d){d.shift(1);var g=!0;if(f.iter(c.applicable,function(a){var b=e.is_string(a)?this[a]:a;g=g&&b.apply(this,d)},this),!g)continue;var h=!0;return f.iter(c.valid,function(a){var b=e.is_string(a)?this[a]:a;h=h&&b.apply(this,d)},this),h?{object:c,params:d}:null}}return null},object:function(a){return this.__paths[a]},path:function(a){for(var b=this.object(a).key,c=Array.prototype.slice.apply(arguments,[1]),d=/\(.*?\)/;;){var e=c.shift();if(!e)break;b=b.replace(d,e)}return b},navigate:function(a){this.trigger("navigate",a);var b=this.parse(a);return null===b?(this.trigger("navigate-fail",a),!1):(this.trigger("navigate-success",b.object,b.params),this.invoke(b.object,b.params,a))},invoke:function(a,b,c){c=c||this.path(a.key,b),this.trigger("before_invoke",a,b,c),this.__enter(a,b,c),this.trigger("after_invoke",a,b,c);var d=this._invoke(a,b);return d},_invoke:function(a,b){var c=a.action;return e.is_string(c)&&(c=this[c]),c?c.apply(this,b):!1},__leave:function(){null!==this.__current&&(this.trigger("leave",this.__current),this.__current.destroy(),this.__current=null)},__enter:function(a,b,d){this.__leave(),this.__current=new c,this.__current.route=d,this.__current.object=a,this.__current.params=b,this.trigger("enter",this.__current)},current:function(){return this.__current}}}])}),a.define("module:RouterHistory",["base:Class","base:Events.EventsMixin"],function(a,b,c){return a.extend({scoped:c},[b,function(a){return{constructor:function(b){a.constructor.call(this),this.__router=b,this.__history=[],b.on("after_invoke",this.__after_invoke,this)},destroy:function(){this.__router.off(null,null,this),a.destroy.call(this)},__after_invoke:function(a,b){this.__history.push({object:a,params:b}),this.trigger("change")},last:function(a){return a=a||0,this.get(this.count()-1-a)},count:function(){return this.__history.length},get:function(a){return a=a||0,this.__history[a]},getRoute:function(a){var b=this.get(a);return this.__router.path(b.object.path,b.params)},back:function(a){if(this.count()<2)return null;for(a=a||0;a>=0&&this.count()>1;)this.__history.pop(),--a;var b=this.__history.pop();return this.trigger("change"),this.__router.invoke(b.object,b.params)}}}])}),a.define("module:RouteBinder",["base:Class"],function(a,b){return a.extend({scoped:b},function(a){return{constructor:function(b){a.constructor.call(this),this.__router=b,this.__router.on("after_invoke",function(a,b,c){this._getExternalRoute()!=c&&this._setExternalRoute(c,b,a)},this)},destroy:function(){this.__router.off(null,null,this),a.destroy.call(this)},current:function(){return this._getExternalRoute()},_setRoute:function(a){var b=this.__router.current();b&&b.route==a||this.__router.navigate(a)},_getExternalRoute:function(){return null},_setExternalRoute:function(){}}})}),a.define("module:HashRouteBinder",["module:RouteBinder","jquery:"],function(a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(c){a.constructor.call(this,c);var d=this;b(window).on("hashchange.events"+this.cid(),function(){d._setRoute(d._getExternalRoute())})},destroy:function(){b(window).off("hashchange.events"+this.cid()),a.destroy.call(this)},_getExternalRoute:function(){var a=window.location.hash;return a.length&&"#"==a[0]?a.slice(1):a},_setExternalRoute:function(a){window.location.hash="#"+a}}})}),a.define("module:HistoryRouteBinder",["module:RouteBinder","jquery:"],function(a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(c){a.constructor.call(this,c);var d=this;this.__used=!1,b(window).on("popstate.events"+this.cid(),function(){d.__used&&d._setRoute(d._getExternalRoute())})},destroy:function(){b(window).off("popstate.events"+this.cid()),a.destroy.call(this)},_getExternalRoute:function(){return window.location.pathname},_setExternalRoute:function(a){window.history.pushState({},document.title,a),this.__used=!0}}},{supported:function(){return window.history&&window.history.pushState}})}),a.define("module:LocationRouteBinder",["module:RouteBinder"],function(a,b){return a.extend({scoped:b},{_getExternalRoute:function(){return window.location.pathname},_setExternalRoute:function(a){window.location.pathname=a}})}),a.define("module:StateRouteBinder",["module:RouteBinder","base:Objs"],function(a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(c,d){a.constructor.call(this,c),this._host=d,this._states={},b.iter(c.routes,function(a){a.state&&(this._states[a.state]=a)},this),d.on("start",function(){this._setRoute(this._getExternalRoute)},this)},destroy:function(){this._host.off(null,null,this),a.destroy.call(this)},_getExternalRoute:function(){var a=this._host.state(),c=this._states[a.state_name()];if(!c)return null;var d=/\(.*?\)/,e=c.key;return b.iter(c.mapping,function(b){e=e.replace(d,a["_"+b])},this),e},_setExternalRoute:function(a,c,d){var e={};b.iter(d.mapping,function(a,b){e[a]=c[b]}),this._host.next(d.state,e)}}})})}).call(Scoped);